---
phase: 14.3-address-issues-in-ddd-audit-report
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventDispatcher.cs
  - src/BuildingBlocks/BuildingBlocks.Common/Events/MediatorDomainEventDispatcher.cs
  - src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventHandler.cs
  - src/BuildingBlocks/BuildingBlocks.Common/DependencyInjection.cs
autonomous: true

must_haves:
  truths:
    - "Obsolete domain event dispatcher infrastructure files are deleted from the codebase"
    - "No references to IDomainEventDispatcher, MediatorDomainEventDispatcher, or IDomainEventHandler exist anywhere"
    - "The DependencyInjection.cs file in BuildingBlocks.Common is deleted (only contained the obsolete registration method)"
    - "Solution builds cleanly without the removed files"
  artifacts:
    - path: "src/BuildingBlocks/BuildingBlocks.Common/Events/"
      provides: "Clean events directory with only DomainEvent.cs, EventId.cs, IDomainEvent.cs"
  key_links:
    - from: "src/BuildingBlocks/BuildingBlocks.Common/"
      to: "No consumers"
      via: "No references to obsolete types anywhere in codebase"
      pattern: "IDomainEventDispatcher|MediatorDomainEventDispatcher|IDomainEventHandler|AddMediatorDomainEventDispatcher"
---

<objective>
Remove the obsolete domain event dispatcher infrastructure (IDomainEventDispatcher, MediatorDomainEventDispatcher, IDomainEventHandler, and the DependencyInjection extension method) from BuildingBlocks.Common.

Purpose: These types were marked [Obsolete] and replaced by MassTransit with the transactional outbox pattern (DomainEventInterceptor). They have zero consumers in the current codebase. Keeping them is dead code that creates confusion about which event dispatching pattern to use. Removing them enforces the single approved pattern.

Output: Clean BuildingBlocks.Common/Events directory with only DomainEvent.cs, EventId.cs, and IDomainEvent.cs.
</objective>

<execution_context>
@/Users/baotoq/.claude/get-shit-done/workflows/execute-plan.md
@/Users/baotoq/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventDispatcher.cs
@src/BuildingBlocks/BuildingBlocks.Common/Events/MediatorDomainEventDispatcher.cs
@src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventHandler.cs
@src/BuildingBlocks/BuildingBlocks.Common/DependencyInjection.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify no consumers exist and remove obsolete domain event dispatcher files</name>
  <files>
    src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventDispatcher.cs
    src/BuildingBlocks/BuildingBlocks.Common/Events/MediatorDomainEventDispatcher.cs
    src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventHandler.cs
    src/BuildingBlocks/BuildingBlocks.Common/DependencyInjection.cs
  </files>
  <action>
    1. **Verify zero consumers** before deleting anything:
       - Grep the entire `src/` directory for `IDomainEventDispatcher` (excluding the definition file itself) — must return 0 results
       - Grep for `MediatorDomainEventDispatcher` (excluding definition) — must return 0 results
       - Grep for `IDomainEventHandler` (excluding definition) — must return 0 results
       - Grep for `AddMediatorDomainEventDispatcher` — must return 0 results
       If ANY grep returns consumers, STOP and document which files reference these types.

    2. **Delete the four files:**
       - `src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventDispatcher.cs` — the obsolete interface
       - `src/BuildingBlocks/BuildingBlocks.Common/Events/MediatorDomainEventDispatcher.cs` — the obsolete implementation
       - `src/BuildingBlocks/BuildingBlocks.Common/Events/IDomainEventHandler.cs` — the obsolete handler interface
       - `src/BuildingBlocks/BuildingBlocks.Common/DependencyInjection.cs` — only contains `AddMediatorDomainEventDispatcher` which registers the obsolete dispatcher

    3. **Verify remaining Events directory** contains exactly:
       - `DomainEvent.cs` — base domain event record
       - `EventId.cs` — strongly-typed event ID
       - `IDomainEvent.cs` — domain event interface (used by MassTransit pattern)

    4. **Build the solution** to confirm nothing breaks.
  </action>
  <verify>
    Run `dotnet build` at solution root — must compile with zero errors.
    Run `dotnet test src/MicroCommerce.ApiService.Tests` — all tests pass.
    List files in `src/BuildingBlocks/BuildingBlocks.Common/Events/` — should contain exactly DomainEvent.cs, EventId.cs, IDomainEvent.cs.
    List files in `src/BuildingBlocks/BuildingBlocks.Common/` — DependencyInjection.cs should NOT exist.
  </verify>
  <done>
    All four obsolete files deleted. No compilation errors. No test failures. BuildingBlocks.Common/Events contains only DomainEvent.cs, EventId.cs, IDomainEvent.cs. The codebase has a single domain event dispatch pattern (MassTransit transactional outbox via DomainEventInterceptor).
  </done>
</task>

</tasks>

<verification>
1. `dotnet build` at solution root succeeds
2. `dotnet test src/MicroCommerce.ApiService.Tests` passes
3. Grep for `IDomainEventDispatcher|MediatorDomainEventDispatcher|IDomainEventHandler|AddMediatorDomainEventDispatcher` across entire `src/` returns 0 results
4. `ls src/BuildingBlocks/BuildingBlocks.Common/Events/` shows only DomainEvent.cs, EventId.cs, IDomainEvent.cs
</verification>

<success_criteria>
Obsolete domain event dispatcher infrastructure completely removed. Zero references to removed types anywhere in codebase. Solution builds and all tests pass. Single domain event pattern (MassTransit) is the only remaining approach.
</success_criteria>

<output>
After completion, create `.planning/phases/14.3-address-issues-in-ddd-audit-report/14.3-03-SUMMARY.md`
</output>
